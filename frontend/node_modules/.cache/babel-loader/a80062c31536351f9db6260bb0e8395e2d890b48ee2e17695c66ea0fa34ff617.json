{"ast":null,"code":"import{useState,useEffect}from'react';import{Container,Typography,Box,Button,Paper}from'@mui/material';import{Add}from'@mui/icons-material';import api from'../services/api';import PollCard from'../components/PollCard';import{useAuth}from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PollsPage=()=>{const{user}=useAuth();const[polls,setPolls]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchPolls=async()=>{try{const response=await api.get('/polls');setPolls(response.data);}catch(error){console.error('Error fetching polls:',error);}finally{setLoading(false);}};fetchPolls();},[]);const handleVote=async(pollId,option)=>{try{await api.post('/votes',{poll_id:pollId,option});// Refresh polls after voting\nconst response=await api.get('/polls');setPolls(response.data);}catch(error){console.error('Error voting:',error);}};if(loading)return/*#__PURE__*/_jsx(Typography,{children:\"Loading polls...\"});return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:\"Community Polls\"}),(user===null||user===void 0?void 0:user.is_admin)&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(Add,{}),children:\"Create Poll\"})]}),polls.length===0?/*#__PURE__*/_jsx(Paper,{sx:{p:3,textAlign:'center'},children:/*#__PURE__*/_jsx(Typography,{children:\"No polls available yet.\"})}):polls.map(poll=>/*#__PURE__*/_jsx(PollCard,{poll:poll,onVote:handleVote},poll.id))]});};export default PollsPage;","map":{"version":3,"names":["useState","useEffect","Container","Typography","Box","Button","Paper","Add","api","PollCard","useAuth","jsx","_jsx","jsxs","_jsxs","PollsPage","user","polls","setPolls","loading","setLoading","fetchPolls","response","get","data","error","console","handleVote","pollId","option","post","poll_id","children","maxWidth","sx","display","justifyContent","alignItems","mb","variant","is_admin","startIcon","length","p","textAlign","map","poll","onVote","id"],"sources":["E:/communitypulse/frontend/src/pages/PollsPage.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Container, Typography, Box, Button, Paper } from '@mui/material';\r\nimport { Add } from '@mui/icons-material';\r\nimport api from '../services/api';\r\nimport PollCard from '../components/PollCard';\r\nimport { useAuth } from '../context/AuthContext';\r\n\r\nconst PollsPage = () => {\r\n  const { user } = useAuth();\r\n  const [polls, setPolls] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchPolls = async () => {\r\n      try {\r\n        const response = await api.get('/polls');\r\n        setPolls(response.data);\r\n      } catch (error) {\r\n        console.error('Error fetching polls:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchPolls();\r\n  }, []);\r\n\r\n  const handleVote = async (pollId, option) => {\r\n    try {\r\n      await api.post('/votes', { poll_id: pollId, option });\r\n      // Refresh polls after voting\r\n      const response = await api.get('/polls');\r\n      setPolls(response.data);\r\n    } catch (error) {\r\n      console.error('Error voting:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) return <Typography>Loading polls...</Typography>;\r\n\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 3 }}>\r\n        <Typography variant=\"h4\">Community Polls</Typography>\r\n        {user?.is_admin && (\r\n          <Button variant=\"contained\" startIcon={<Add />}>\r\n            Create Poll\r\n          </Button>\r\n        )}\r\n      </Box>\r\n      \r\n      {polls.length === 0 ? (\r\n        <Paper sx={{ p: 3, textAlign: 'center' }}>\r\n          <Typography>No polls available yet.</Typography>\r\n        </Paper>\r\n      ) : (\r\n        polls.map(poll => (\r\n          <PollCard \r\n            key={poll.id} \r\n            poll={poll} \r\n            onVote={handleVote} \r\n          />\r\n        ))\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default PollsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}